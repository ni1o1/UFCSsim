# Code for "China’s urban EV ultra-fast charging distorts regulated price signals and elevates risk to grid stability"

This repository contains the Python code used for the analysis in the *Nature Communications* article titled: "China’s urban EV ultra-fast charging distorts regulated price signals and elevates risk to grid stability."

The scripts simulate the deployment of Ultra-Fast Charging Stations (UFCS), optimize the operation of co-located Energy Storage Systems (ESS), and assess the resulting risks to the power grid.

---

## File Descriptions

* **`UFCSsim.py`**: This script simulates the process of upgrading existing charging stations to UFCS in Beijing, Guangzhou, and Shanghai. It processes real-world charging records and station data to:
    * Select charging guns for upgrade based on station type and power capacity.
    * Adjust charging durations to reflect the faster speeds of UFCS.
    * Generate pre- and post-upgrade grid load profiles for subsequent risk and ESS analysis.

* **`ESSopt.py`**: This script optimizes the charge/discharge schedule for Energy Storage Systems (ESS) at charging stations to minimize operational costs. Using Google's OR-Tools, it:
    * Models city-specific electricity tariffs, including time-of-use (TOU) and peak demand charges.
    * Uses the load profiles generated by `UFCSsim.py` as input.
    * Calculates necessary ESS parameters like capacity and power.
    * Solves for the least-cost ESS operation schedule while respecting efficiency and physical constraints.

* **`Risk.py`**: This script quantifies the grid stability risks (specifically over-ramping) caused by the load volatility from widespread UFCS adoption. Using the profiles from `UFCSsim.py`, it:
    * Calculates the ramping load (the difference in load between baseline and UFCS scenarios).
    * Estimates the probability of this ramping load exceeding predefined grid reserve thresholds using Kernel Density Estimation (KDE).

---

## Citation

If you use this code or the findings from our study in your research, please cite the original article:

Yu, Q., Zhao, P., Zhang, H. et al. China’s urban EV ultra-fast charging distorts regulated price signals and elevates risk to grid stability. *Nat Commun* **16**, 8451 (2025). [https://doi.org/10.1038/s41467-025-63199-3](https://doi.org/10.1038/s41467-025-63199-3)
